import I from"os";import m from"fs";import n from"crypto";var a=["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-ccm","aes-192-ccm","aes-256-ccm","aes-128-ocb","aes-192-ocb","aes-256-ocb"],x=+process.versions.node.split(".").slice(0,2).join("."),p=Buffer.alloc(16);function h(e,r){return r===void 0||r==="buffer"?e:e.toString(r)}n.randomUUID||(n.randomUUID=function(){let e=n.randomBytes(16).toString("hex");return e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(-12)});n.randomInt||(n.randomInt=function(e){if(e===void 0)throw new TypeError('[ERR_INVALID_ARG_TYPE]: The "max" argument must be a safe integer. Received undefined');return~~(Math.random()*e)});var l=function(e,r,f){let t=n.createHash(e),u=Buffer.isBuffer(r);return t.update(r,u?"buffer":"utf8"),t.digest(f||"hex")},y=function(e,r,f,t){f=f||"";let u=n.createHmac(e,f),o=Buffer.isBuffer(r);return u.update(r,o?"buffer":"utf8"),u.digest(t||"hex")},_=function(e,r,f=p,t="utf8",u){if(x>=10.5)return g(e,r,f,p,t,u);t=Buffer.isBuffer(r)?"buffer":t;let s=n.createCipher(e,f),i=s.update(r,t);return i=Buffer.concat([i,s.final()]),a.indexOf(e)>-1&&(i=Buffer.concat([i,s.getAuthTag()])),h(i,u)},S=function(e,r,f=p,t="base64",u="utf8"){if(x>=10.5)return b(e,r,f,p,t,u);Buffer.isBuffer(r)||(r=Buffer.from(r,t)),t="buffer";let s=n.createDecipher(e,f);if(a.indexOf(e)>-1){let c=r.slice(-16);r=r.slice(0,-16),s.setAuthTag(c)}let i=s.update(r,t);return i=Buffer.concat([i,s.final()]),h(i,u)},g=function(e,r,f=p,t=p,u="utf8",o){u=Buffer.isBuffer(r)?"buffer":u;let i=n.createCipheriv(e,f,t),c=i.update(r,u);return c=Buffer.concat([c,i.final()]),a.indexOf(e)>-1&&(c=Buffer.concat([c,i.getAuthTag()])),h(c,o)},b=function(e,r,f=p,t=p,u="base64",o="utf8"){Buffer.isBuffer(r)||(r=Buffer.from(r,u)),u="buffer";let i=n.createDecipheriv(e,f,t);if(a.indexOf(e)>-1){let v=r.slice(-16);r=r.slice(0,-16),i.setAuthTag(v)}let c=i.update(r,u);return c=Buffer.concat([c,i.final()]),h(c,o)};var d=function(e){for(let r in e){if(r==="lo")continue;return e[r].pop().mac.replace(/:/g,"").slice(-4)}return Math.random().toString(16).slice(-4)}(I.networkInterfaces()),B=4096;function A(e,r){let f,t;return Buffer.isBuffer(e)?f=e:f=Buffer.from(e+""),t=f.toString("base64"),r?t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""):t}function D(e,r){return r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/[^A-Za-z0-9\+\/]/g,"")),Buffer.from(e,"base64")}function T(e=0,r=!1){let f="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM0123456789";r&&(f="0123456789");let t=f.length,u="";for(let o=0;o<e;o++)u+=f[n.randomInt(t)];return u}function U(e="-"){let r=n.randomUUID(),f=(~~(Date.now()/1e3)).toString(16);return B>65535&&(B=4096),r=B.toString(16)+r,B++,f+e+d+e+r.slice(0,4)+e+r.slice(-8)}function O(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("md5",e,r):e}function w(e,r){try{let f=m.readFileSync(e);return l("md5",f,r)}catch{return null}}function R(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("sha1",e,r):e}function F(e,r){try{let f=m.readFileSync(e);return l("sha1",f,r)}catch{return null}}function M(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("sha256",e,r):e}function C(e,r){try{let f=m.readFileSync(e);return l("sha256",f,r)}catch{return null}}function H(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?l("sha512",e,r):e}function N(e,r){try{let f=m.readFileSync(e);return l("sha512",f,r)}catch{return null}}var K={base64encode:A,base64decode:D,rand:T,uuid:U,md5:O,md5Sign:w,sha1:R,sha1Sign:F,sha256:M,sha256Sign:C,sha512:H,sha512Sign:N,crypto:n,origin:n,hash:l,hmac:y,cipher:_,decipher:S,cipheriv:g,decipheriv:b};export{D as base64decode,A as base64encode,_ as cipher,g as cipheriv,n as crypto,S as decipher,b as decipheriv,K as default,l as hash,y as hmac,O as md5,w as md5Sign,n as origin,T as rand,R as sha1,F as sha1Sign,M as sha256,C as sha256Sign,H as sha512,N as sha512Sign,U as uuid};
